<!-- Configuration Modal -->
<div class="modal fade" id="configModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-scrollable">
        <div class="modal-content">
        <!-- Modal Header -->
        <div class="modal-header">
            <div>
                <h5 class="modal-title mb-0"><i class="fas fa-cogs me-2"></i>Configuración General</h5>
                <small class="text-muted">Ajustes principales del sistema</small>
            </div>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        
        <!-- Modal Body -->
        <div class="modal-body p-4">
            <form id="configForm">
                <!-- Company Settings -->
                <div class="mb-4">
                    <h4 class="h6 mb-3 d-flex align-items-center">
                        <i class="fas fa-building text-purple me-2"></i>
                        Información de la Empresa
                    </h4>
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label class="form-label">Nombre de la Empresa</label>
                            <input type="text" name="company_name" value="PACTA Solutions" class="form-control">
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">NIT/RUT</label>
                            <input type="text" name="company_nit" value="900123456-7" class="form-control">
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Teléfono</label>
                            <input type="text" name="company_phone" value="+57 1 234 5678" class="form-control">
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Email</label>
                            <input type="email" name="company_email" value="info@pacta.com" class="form-control">
                        </div>
                    </div>
                </div>
                
                <!-- System Settings -->
                <div class="mb-4">
                    <h4 class="h6 mb-3 d-flex align-items-center">
                        <i class="fas fa-server text-purple me-2"></i>
                        Configuración del Sistema
                    </h4>
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label class="form-label">Zona Horaria</label>
                            <select name="timezone" class="form-select">
                                <option value="America/Bogota" selected>America/Bogota</option>
                                <option value="America/Mexico_City">America/Mexico_City</option>
                                <option value="America/Lima">America/Lima</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Idioma</label>
                            <select name="language" class="form-select">
                                <option value="es" selected>Español</option>
                                <option value="en">English</option>
                                <option value="pt">Português</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Moneda</label>
                            <select name="currency" class="form-select">
                                <option value="COP" selected>COP - Peso Colombiano</option>
                                <option value="USD">USD - Dólar Americano</option>
                                <option value="EUR">EUR - Euro</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Formato de Fecha</label>
                            <select name="date_format" class="form-select">
                                <option value="DD/MM/YYYY" selected>DD/MM/YYYY</option>
                                <option value="MM/DD/YYYY">MM/DD/YYYY</option>
                                <option value="YYYY-MM-DD">YYYY-MM-DD</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- Notification Settings -->
                <div class="mb-2">
                    <h4 class="h6 mb-3 d-flex align-items-center">
                        <i class="fas fa-bell text-purple me-2"></i>
                        Notificaciones
                    </h4>
                    <div class="d-flex flex-column gap-2">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="email_notifications" id="email_notifications" checked>
                            <label class="form-check-label" for="email_notifications">
                                <span class="d-block fw-semibold">Notificaciones por email</span>
                                <span class="text-muted text-small">Recibir notificaciones importantes por correo electrónico</span>
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="contract_alerts" id="contract_alerts" checked>
                            <label class="form-check-label" for="contract_alerts">
                                <span class="d-block fw-semibold">Alertas de contratos próximos a vencer</span>
                                <span class="text-muted text-small">Notificaciones automáticas antes del vencimiento</span>
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="weekly_reports" id="weekly_reports">
                            <label class="form-check-label" for="weekly_reports">
                                <span class="d-block fw-semibold">Reportes automáticos semanales</span>
                                <span class="text-muted text-small">Resumen semanal de actividades y métricas</span>
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="system_notifications" id="system_notifications" checked>
                            <label class="form-check-label" for="system_notifications">
                                <span class="d-block fw-semibold">Notificaciones de sistema</span>
                                <span class="text-muted text-small">Alertas sobre el estado del sistema y actualizaciones</span>
                            </label>
                        </div>
                    </div>
                </div>
            </form>
        </div>
        
        <!-- Modal Footer -->
        <div class="modal-footer d-flex justify-content-end gap-2">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                Cancelar
            </button>
            <button type="button" class="btn btn-primary" onclick="saveConfiguration()">
                <i class="fas fa-save me-1"></i>
                Guardar Cambios
            </button>
        </div>
        </div>
    </div>
</div>

<script>
    function saveConfiguration() {
        const form = document.getElementById('configForm');
        const formData = new FormData(form);
        
        // Convert FormData to object
        const config = {};
        for (let [key, value] of formData.entries()) {
            if (form.elements[key].type === 'checkbox') {
                config[key] = form.elements[key].checked;
            } else {
                config[key] = value;
            }
        }
        
        // Add unchecked checkboxes
        const checkboxes = form.querySelectorAll('input[type="checkbox"]');
        checkboxes.forEach(checkbox => {
            if (!formData.has(checkbox.name)) {
                config[checkbox.name] = false;
            }
        });
        
        console.log('Configuración a guardar:', config);
        
        // Mostrar mensaje y cerrar el modal con la API de Bootstrap
        showNotification('Configuración guardada exitosamente', 'success');
        const modalEl = document.getElementById('configModal');
        if (modalEl) {
            const modalInstance = bootstrap.Modal.getInstance(modalEl) || new bootstrap.Modal(modalEl);
            modalInstance.hide();
        }
    }
    
    // El resto del control del modal lo maneja Bootstrap (data-bs-*)
</script>